

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the GUI &mdash; suite2p 0.6.17 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Outputs" href="outputs.html" />
    <link rel="prev" title="Settings (ops.npy)" href="settings.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> suite2p
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Basics:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Settings (ops.npy)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using the GUI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#different-views-and-colors-for-roi-panels">Different views and colors for ROI panels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#views">Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="#colors">Colors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#correlations">Correlations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#correlations-with-1d-var">Correlations with 1D var</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rastermap-custom">Rastermap / custom</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#buttons-shortcuts-for-cell-selection">Buttons / shortcuts for cell selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mouse-control">Mouse control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#keyboard-shortcuts">Keyboard shortcuts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multi-cell-selection">Multi-cell selection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#trace-view-bottom-row">Trace view (bottom row)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classifying-cells">Classifying cells</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-data-to-a-classifier">Adding data to a classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-your-own-classifier">Building your own classifier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#visualizing-activity">Visualizing activity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manual-adding-of-rois">Manual adding of ROIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#view-registered-binary">View registered binary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#z-stack-alignment">Z-stack Alignment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#view-registration-metrics">View registration metrics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="outputs.html">Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiday.html">Multiday recordings</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption"><span class="caption-text">How it works:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="celldetection.html">Cell detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="roiextraction.html">Signal extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="deconvolution.html">Spike deconvolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/index.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">suite2p</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Using the GUI</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/gui.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-the-gui">
<h1>Using the GUI<a class="headerlink" href="#using-the-gui" title="Permalink to this headline">¶</a></h1>
<p>Once you’ve run the processing, you can open the output <code class="docutils literal notranslate"><span class="pre">stat.npy</span></code>
file from the GUI. This allows you to explore the data in depth both
spatially and in time. In addition you can classify ROIs as ‘cells’ or
‘NOT cells’ (left or right side of screen) and train a classifier to
automatically identify the cells as one of these two classes. Note that
these categories do not have to be ‘cells’ and ‘NOT cells’, they could
be ‘boutons’ and ‘NOT boutons’, we just chose to say ‘cells’ because
that’s the most common ROI studied.</p>
<p>You can now <strong>drag and drop</strong> your <code class="docutils literal notranslate"><span class="pre">stat.npy</span></code> files into the GUI!</p>
<div class="section" id="different-views-and-colors-for-roi-panels">
<h2>Different views and colors for ROI panels<a class="headerlink" href="#different-views-and-colors-for-roi-panels" title="Permalink to this headline">¶</a></h2>
<div class="section" id="views">
<h3>Views<a class="headerlink" href="#views" title="Permalink to this headline">¶</a></h3>
<p>To turn off ROIs in views 2-4, uncheck <em>ROIs on</em></p>
<ol class="arabic simple">
<li><p><em>ROIs</em>: ROIs only are drawn</p></li>
<li><p><em>mean img</em>: mean image is shown in background</p></li>
<li><p><em>mean img (enhanced)</em>: mean image filtered with a min-max filter
shown in background</p></li>
<li><p><em>correlation map</em>: map of correlated pixels shown in background</p></li>
<li><p><em>mean img (non-functional)</em>: the non-functional mean image shown in
background (if nchannels=2)</p></li>
</ol>
</div>
<div class="section" id="colors">
<h3>Colors<a class="headerlink" href="#colors" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="_images/colorbar.png"><img alt="_images/colorbar.png" src="_images/colorbar.png" style="width: 600px;" /></a>
<p>Randomly colored ROI view is the default view. The ROIs in the random
view are colored between purple and yellow, with red reserved for ROIs
assigned to be RED based on the non-functional channel (you can change
the threshold for calling a cell RED with the number next to the chan2
prob button). The other color views color the ROIs based on their
statistics. The values of those statistics are shown in the colorbar
below the buttons.</p>
<p>Here is more info about the less explanatory views:</p>
</div>
<div class="section" id="correlations">
<h3>Correlations<a class="headerlink" href="#correlations" title="Permalink to this headline">¶</a></h3>
<p>In correlation color view, the selected cell’s activity (or the mean of
the selected cells’ activities) is correlated with the activity of all
the other ROIs. The ROIs are colored according to these correlations.
The bin in which to compute the correlations can be chosen (in units of
frames). The default bin size is the number of frames per second
(<code class="docutils literal notranslate"><span class="pre">ops['fs']</span></code>).</p>
<p>If a 1D external variable is loaded, then the <em>corr with 1D var</em> button
is activated. The cells are then colored according to their correlation
with the external variable. The bin size is determined by the box next
to the <em>correlations</em> button.</p>
</div>
<div class="section" id="correlations-with-1d-var">
<h3>Correlations with 1D var<a class="headerlink" href="#correlations-with-1d-var" title="Permalink to this headline">¶</a></h3>
<p>You can load an external stimulus or behavioral trace (1D) using “File -
Load behavior or stim trace (1D only)”. The GUI expects a *.npy file
that is the same length as the data in time (F.shape[1] from “F.npy”).
You can then look at the correlation of each cell with this trace. And
it will be plotted along with the cell traces if you select multiple
cells or in the “Visualize” menu.</p>
</div>
<div class="section" id="rastermap-custom">
<span id="id1"></span><h3>Rastermap / custom<a class="headerlink" href="#rastermap-custom" title="Permalink to this headline">¶</a></h3>
<p>Rastermap: Click ‘Visualize selected cells’ in the Visualizations menu
and run rastermap on the cells. The selected cells (which could be all
cells on LEFT or RIGHT) will then be colored based on their position in
the rastermap.</p>
<p>Custom map: Use ‘Load custom hue’ in the Visualizations menu to load a
*.npy file with the same number of values as ROIs (length of stat) and
these values will become the hues of the cells (scaled to between 0 and 1) for the
HSV map. If you do rastermap after this then the colors will change and
vice versa this will overwrite the rastermap colors.</p>
</div>
</div>
<div class="section" id="buttons-shortcuts-for-cell-selection">
<span id="id2"></span><h2>Buttons / shortcuts for cell selection<a class="headerlink" href="#buttons-shortcuts-for-cell-selection" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mouse-control">
<h3>Mouse control<a class="headerlink" href="#mouse-control" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><strong>double left click = returns to full view in ALL PLOTS</strong></p></li>
<li><p>left click = select cell</p></li>
<li><p>left click + CTRL = select multiple cells</p></li>
<li><p>left click + drag = moves field of view</p></li>
<li><p>right click = flip selected cell(s) from left&lt;-&gt;right, – or if
clicked in trace view, will open up “export” option</p></li>
<li><p>scroll wheel = zoom in and out</p></li>
</ul>
</div>
<div class="section" id="keyboard-shortcuts">
<h3>Keyboard shortcuts<a class="headerlink" href="#keyboard-shortcuts" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Esc = returns to full view</p></li>
<li><p>Delete = removes box from <em>draw selection</em> from window For the
letters, just press the letter (do not capitalize)</p></li>
<li><p>O = turn of ROIs in non-ROI view</p></li>
<li><p>Q-U = different views (can change saturation with slider)</p></li>
<li><p>A-M = different color maps</p></li>
<li><p>Left and right keys = cycle between cells of same panel</p></li>
<li><p>Up Key = flip selected cell to other panel</p></li>
<li><p>Alt+Enter = merge selected ROIs</p></li>
</ul>
<ul class="simple">
<li><p>note you can also ask the GUI to auto-suggest merges with the Merge&gt;Auto-suggest merges window *</p></li>
</ul>
</div>
<div class="section" id="multi-cell-selection">
<h3>Multi-cell selection<a class="headerlink" href="#multi-cell-selection" title="Permalink to this headline">¶</a></h3>
<p>You can select multiple cells by holding down CTRL while left-clicking
on cells. If you are in ‘cells’ or ‘NOT cells’ view (not ‘both’ view),
then several buttons for multi-cell selection activate.</p>
<a class="reference internal image-reference" href="_images/multi_select.PNG"><img alt="_images/multi_select.PNG" src="_images/multi_select.PNG" style="width: 600px;" /></a>
<p>The <em>draw selection</em> button activates a box that you can drag and resize
to select multiple cells. To delete the box, click the Delete key.
<em>select top n</em> selects n=X top neurons from the current colormap. For
instance, in ‘skew’ view, <em>select top n</em> will select the most skewed
neurons. In ‘correlation’ view, it will choose the most correlated
neurons with the currently selected neuron.</p>
</div>
</div>
<div class="section" id="trace-view-bottom-row">
<h2>Trace view (bottom row)<a class="headerlink" href="#trace-view-bottom-row" title="Permalink to this headline">¶</a></h2>
<p>When one cell is selected, the fluorescence, neuropil and deconvolved
traces are shown for the chosen cell in the bottom row of the GUI. When
multiple cells are selected, you can choose what type of traces to view
with the drop-down menu in the lower left:</p>
<ul class="simple">
<li><p>F: fluorescence</p></li>
<li><p>Fneu: neuropil fluorescence</p></li>
<li><p>F - 0.7*Fneu: corrected fluorescence</p></li>
<li><p>deconvolved: deconvolution of corrected fluorescence</p></li>
</ul>
<p>You can resize the trace view with the triangle buttons (bigger = ▲,
smaller = ▼). If multiple cells are selected, you can vary how much the
traces overlap with the +/- buttons.</p>
<p>You can select as many cells as you want, but by default only 40 of
those will be plotted. You can increase or decrease this number by
changing the number in the box below <em>max # plotted</em>.</p>
<p>You can hide the fluorescence, neuropil and/or the deconvolved traces by
toggling the chechboxes or using the keys as follows:</p>
<p>Deconvolved - N key
Neuropil - B Key
Fluorescence - V Key</p>
</div>
<div class="section" id="classifying-cells">
<h2>Classifying cells<a class="headerlink" href="#classifying-cells" title="Permalink to this headline">¶</a></h2>
<p>suite2p comes with a <em>built-in</em> classifier (based on our own manual
curation of GCaMP6s imaging of cells in cortex). The <em>default</em>
classifier is initialized as the <em>built-in</em> classifier, but can be
modified by the user.</p>
<p>After running suite2p, the cells are automatically classified by the
default classifier (at the time of running the pipeline), and these cell
probabilities are shown as the colors in the <em>classifier</em> view. You can
then further manually curate this data (flipping cells left and right
depending on your criteria).</p>
<div class="section" id="adding-data-to-a-classifier">
<h3>Adding data to a classifier<a class="headerlink" href="#adding-data-to-a-classifier" title="Permalink to this headline">¶</a></h3>
<p>You can add this manually curated data to an already built classifier:</p>
<ol class="arabic simple">
<li><p>Load a classifier by going to the “Classifier” menu and clicking
“Load”. Choose the <em>default</em> classifier, or load another classifier
that you’ve built and saved with the <em>from file</em> option.</p></li>
<li><p>Click the <em>add current data to classifier</em> button. This will either
overwrite the classifier file that is loaded, or you can specify a
file location for the classifier with this newly added data.</p></li>
</ol>
</div>
<div class="section" id="building-your-own-classifier">
<h3>Building your own classifier<a class="headerlink" href="#building-your-own-classifier" title="Permalink to this headline">¶</a></h3>
<p>Go to the “Classifier” menu and click “Build”. A window will pop up and
in the window you can add datasets as training samples for the
classifier. Click the <em>Load iscell.npy</em> button and add an <code class="docutils literal notranslate"><span class="pre">iscell.npy</span></code>
file. You can add as many as you like, then click <em>build classifier</em>,
and it will ask you to specify a file location for the new classifier.
Then you can load the classifier that you built into the GUI, or you can
save it as your default classifier.</p>
</div>
</div>
<div class="section" id="visualizing-activity">
<h2>Visualizing activity<a class="headerlink" href="#visualizing-activity" title="Permalink to this headline">¶</a></h2>
<p>Go to the “Visualizations” menu and click “Visualize selected cells”. If
only one ROI is selected, then all ROIs in that view (cell or not cell)
will be plotted. Otherwise the selected cells are plotted. You can sort
the neurons by their principal component weights, or by our algorithm
<a class="reference external" href="http://www.github.com/mouseland/rastermap">rastermap</a> by clicking the compute buttons. Once you click the
<em>compute</em> buttons, they will be grayed out, because you can’t compute
them again (they won’t change). The plot below shows a mesoscope
recording sorted by rastermap. You can change between sorting by
rastermap and by the PCs by using the drop-down menu.</p>
<a class="reference internal image-reference" href="_images/visualize.png"><img alt="_images/visualize.png" src="_images/visualize.png" style="width: 600px;" /></a>
<p>The red box allows you to zoom in on specific segments of the recording.
You can move it by dragging the mouse when in the box, or with the arrow
keys. You can resize it by using the diamond handles on the sides of the
box, or by holding down the shift key and using the arrow keys.</p>
<p>If you click the <em>show selected cells in GUI</em> button, then the cells
surrounded by the red box will show up as white in the GUI.</p>
<a class="reference internal image-reference" href="_images/visualize_selected.png"><img alt="_images/visualize_selected.png" src="_images/visualize_selected.png" style="width: 600px;" /></a>
</div>
<div class="section" id="manual-adding-of-rois">
<h2>Manual adding of ROIs<a class="headerlink" href="#manual-adding-of-rois" title="Permalink to this headline">¶</a></h2>
<p>You can add ROIs in the File&gt;Manual labelling. You MUST keep the binary file for the
computing of the mask’s activity across time. When you save and exit the ROIs will be
added to the <a href="#id3"><span class="problematic" id="id4">*</span></a>.npy files as the first N ROIs (where N is the number that you drew).</p>
<a class="reference internal image-reference" href="_images/manual_roi.png"><img alt="_images/manual_roi.png" src="_images/manual_roi.png" style="width: 600px;" /></a>
</div>
<div class="section" id="view-registered-binary">
<h2>View registered binary<a class="headerlink" href="#view-registered-binary" title="Permalink to this headline">¶</a></h2>
<p>Open the “Registration” menu and click “View registered binary”. A
window will pop up with the binary file loaded (first row) along with
the registration shifts (second row), and the fluorescence of a selected
ROI (third row). If ops[‘keep_movie_raw’]=1, then both the unregistered
and registered binaries will be shown in the first row. You can select
an ROI by typing in the ROI number in the upper right.</p>
<p>You can zoom in and out on any of the plots. The shift plot and the
fluorescence plot have linked x-axes. To return to full view,
double-click on the plot that you want to recenter.</p>
<p>When not playing the movie, you can click on the shift plot and the
fluorescence plot to go to a specific point in time in the movie. You
can also seek through the movie by clicking the slide bar. The left and
right arrow keys will move the slide bar incrementally. The space bar will pause and play the movie.</p>
<a class="reference internal image-reference" href="_images/binary.png"><img alt="_images/binary.png" src="_images/binary.png" style="width: 600px;" /></a>
<p>You can also view all the masks, and go from cell to cell by clicking on them.</p>
<a class="reference internal image-reference" href="_images/binary_masks.png"><img alt="_images/binary_masks.png" src="_images/binary_masks.png" style="width: 600px;" /></a>
<div class="section" id="z-stack-alignment">
<h3>Z-stack Alignment<a class="headerlink" href="#z-stack-alignment" title="Permalink to this headline">¶</a></h3>
<p>You can also now load a Z-stack into this view. You can compute the z-position of the recording across time
IF you keep the registered binary file. It expects the Z-stack to be a tiff with number of planes
by number of pixels in Y by number of pixels in X. The results of the correlation between z-stack and each frame are saved in
ops[‘zcorr’] which is number of planes (in Z) x number of frames. The GUI smooths this matrix across Z and then takes the max
and plots the max across time in the third row.</p>
</div>
</div>
<div class="section" id="view-registration-metrics">
<h2>View registration metrics<a class="headerlink" href="#view-registration-metrics" title="Permalink to this headline">¶</a></h2>
<p>Open the “Registration” menu and click “View registration metrics”. A
window will pop up with ops[‘regDX’] and ops[‘regPC’] plotted. The
ops[‘regPC’]’s are computed by taking the principal components of the
registered movie. <code class="docutils literal notranslate"><span class="pre">ops['regPC'][0,0,:,:]</span></code> is the average of the top
500 frames of the 1st PC, <code class="docutils literal notranslate"><span class="pre">ops['regPC'][1,0,:,:]</span></code> is the average of
the bottom 500 frames of the 1st PC. <code class="docutils literal notranslate"><span class="pre">ops['regDX']</span></code> quantifies the
movement in each PC (<code class="docutils literal notranslate"><span class="pre">iPC</span></code>) by registering <code class="docutils literal notranslate"><span class="pre">ops['regPC'][0,iPC,:,:]</span></code>
and <code class="docutils literal notranslate"><span class="pre">ops['regPC'][1,iPC,:,:]</span></code> to the reference images and computing
the registration shifts.</p>
<p>The first plot in the upper left shows the magnitude of the shifts (both
rigid and non-rigid) in the PCs (<code class="docutils literal notranslate"><span class="pre">ops['regDX']</span></code>). The second row of
plots are meant to help explore the direction of the PC. The first image
is the “difference” between the top and the bottom of the PC. The second
image is the “merged” image of the top and bottom of the PC. The third
image allows you to flip between the top and bottom PCs using the “play”
button.</p>
<p>The left and right arrow keys will change the PC number (or you can type
in a number). The space bar will pause and play the movie.</p>
<p>The example below shows a movie that has been rigid registered but not
non-rigid registered. The metrics suggest that non-rigid registration
should also be performed on this recording.</p>
<a class="reference internal image-reference" href="_images/reg_metrics.png"><img alt="_images/reg_metrics.png" src="_images/reg_metrics.png" style="width: 600px;" /></a>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="outputs.html" class="btn btn-neutral float-right" title="Outputs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="settings.html" class="btn btn-neutral float-left" title="Settings (ops.npy)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Carsen Stringer, Marius Pachitariu

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>